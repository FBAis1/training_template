// generateCharacter 함수 내부의 systemPrompt 수정 제안

let systemPrompt = `
  // ... (기존 상단 내용 유지) ...

  [커맨드 생성 규칙]
  1. 총 5개의 커맨드를 생성하세요.
  2. 최소 1개는 기력 회복(staminaCost < 0), 최소 1개는 스트레스 감소(stressGain < 0) 기능을 가져야 합니다.
  3. **각 커맨드의 'id'는 'cmd_'로 시작하는 영문 소문자여야 합니다. (예: cmd_attack, cmd_rest)**

  [이벤트 생성 규칙]
  1. 총 25개의 이벤트를 생성하세요.
  2. **이벤트의 논리적 연결(conditions)을 위해, 앞서 정의한 '커맨드 ID'를 정확히 참조해야 합니다.**
  3. 조건부 이벤트(conditions 필드가 있는 경우)를 최소 10개 이상 만드세요. 
     - 예: 'cmd_rest' 커맨드 실행 시 발생하는 이벤트라면, conditions: { requiredCommandId: "cmd_rest" } 로 설정.
  4. ${hasUserTag ? "캐릭터 배경에 '{{user}}'가 언급되어 있으므로..." : "..."} (기존 유지)
  5. 각 이벤트 'text'는 3~5줄의 서술형으로 상세히 작성하세요.
  6. **statEffects**를 적극 활용하여, 이벤트 결과로 스탯이 변화하도록 설계하세요.

  [데이터 정합성 중요 규칙]
  - events 배열 내에서 conditions.requiredCommandId에 들어가는 값은, 반드시 commands 배열에 존재하는 id와 100% 일치해야 합니다.
  - 오타나 띄어쓰기가 다르면 게임이 동작하지 않습니다.
`;
